name: AMD Stock Data Update

on:
  schedule:
    - cron: '30 21 * * 1-5'
  workflow_dispatch:

jobs:
  update-stock-data:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
    - uses: actions/checkout@v3
    
    - uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: Extract AMD Stock Data
      run: |
        pip install yfinance
        
        python -c "
import yfinance as yf
from datetime import datetime

# Descargar datos
data = yf.download('AMD', period='5d', progress=False)

# Guardar CSV
if not data.empty:
    data.to_csv('amd_stock_data.csv')
    print(f'‚úÖ Guardado: {len(data)} registros')
    print(f'üìä √öltimo precio: \${data[\"Close\"].iloc[-1]:.2f}')
else:
    # Archivo vac√≠o si no hay datos
    with open('amd_stock_data.csv', 'w') as f:
        f.write('Date,Open,High,Low,Close,Volume\\n')
        f.write(f'{datetime.now():%Y-%m-%d},0,0,0,0,0\\n')
    print('‚ö†Ô∏è Sin datos - archivo vac√≠o creado')
"
    
    - name: Commit Changes
      run: |
        git config user.name "GitHub Actions"
        git config user.email "actions@github.com"
        git add amd_stock_data.csv
        git commit -m "Update AMD data $(date +%Y-%m-%d)" || echo "No changes"
        git push || echo "No push needed"
